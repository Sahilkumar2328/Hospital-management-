CREATE DATABASE HospitalDB;
USE HospitalDB;

CREATE TABLE Patients (
    PatientID INT PRIMARY KEY AUTO_INCREMENT,
    Name VARCHAR(100),
    Gender VARCHAR(10),
    DOB DATE,
    Phone VARCHAR(15),
    Address VARCHAR(200)
);

CREATE TABLE Doctors (
    DoctorID INT PRIMARY KEY AUTO_INCREMENT,
    Name VARCHAR(100),
    Specialty VARCHAR(50),
    Phone VARCHAR(15)
);

CREATE TABLE Appointments (
    AppointmentID INT PRIMARY KEY AUTO_INCREMENT,
    PatientID INT,
    DoctorID INT,
    AppointmentDate DATE,
    Diagnosis VARCHAR(200),
    FOREIGN KEY (PatientID) REFERENCES Patients(PatientID),
    FOREIGN KEY (DoctorID) REFERENCES Doctors(DoctorID)
);

CREATE TABLE Treatments (
    TreatmentID INT PRIMARY KEY AUTO_INCREMENT,
    AppointmentID INT,
    TreatmentDescription VARCHAR(200),
    Cost DECIMAL(10,2),
    FOREIGN KEY (AppointmentID) REFERENCES Appointments(AppointmentID)
);

CREATE TABLE Bills (
    BillID INT PRIMARY KEY AUTO_INCREMENT,
    PatientID INT,
    BillDate DATE,
    TotalAmount DECIMAL(10,2),
    FOREIGN KEY (PatientID) REFERENCES Patients(PatientID)
);

INSERT INTO Patients (Name, Gender, DOB, Phone, Address) VALUES
('Sahil Kumar', 'Male', '1999-04-12', '9876543210', 'Delhi'),
('Ananya Sharma', 'Female', '2001-07-20', '9988776655', 'Mumbai');

INSERT INTO Doctors (Name, Specialty, Phone) VALUES
('Dr. Mehta', 'Cardiology', '9811223344'),
('Dr. Kapoor', 'Orthopedics', '9877112233');

INSERT INTO Appointments (PatientID, DoctorID, AppointmentDate, Diagnosis) VALUES
(1, 1, '2025-08-10', 'High Blood Pressure'),
(2, 2, '2025-08-11', 'Fractured Arm');

INSERT INTO Treatments (AppointmentID, TreatmentDescription, Cost) VALUES
(1, 'Blood Pressure Medication', 1500.00),
(2, 'Plaster Cast', 2500.00);

INSERT INTO Bills (PatientID, BillDate, TotalAmount) VALUES
(1, '2025-08-10', 1500.00),
(2, '2025-08-11', 2500.00);

-- 1. View all appointments with doctor and patient names
SELECT a.AppointmentID, p.Name AS Patient, d.Name AS Doctor, a.AppointmentDate, a.Diagnosis
FROM Appointments a
JOIN Patients p ON a.PatientID = p.PatientID
JOIN Doctors d ON a.DoctorID = d.DoctorID;

-- 2. Calculate total revenue generated
SELECT SUM(TotalAmount) AS TotalRevenue FROM Bills;

-- 3. Find the most expensive treatment
SELECT TreatmentDescription, Cost
FROM Treatments
ORDER BY Cost DESC
LIMIT 1;

-- 4. Show patients with bills greater than 2000
SELECT p.Name, b.TotalAmount
FROM Bills b
JOIN Patients p ON b.PatientID = p.PatientID
WHERE b.TotalAmount > 2000;
